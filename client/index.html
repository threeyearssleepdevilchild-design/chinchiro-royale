<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>異能チンチロ・ロワイヤル</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700;900&family=Cinzel:wght@700;900&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="styles/main.css?v=7">
    <link rel="stylesheet" href="styles/dice.css?v=1">


    <style>
        /* 画面コンテナ自体を最前面に持ってくる */
        .screen.active {
            z-index: 10000 !important;
            /* 他のあらゆる要素より手前に */
            pointer-events: auto !important;
            /* クリックを強制許可 */
        }

        /* 入力欄のクリック判定を確実に */
        .gold-input {
            position: relative;
            z-index: 10001 !important;
            /* 画面コンテナよりさらに手前に */
            pointer-events: auto !important;
        }

        /* もし透明なオーバーレイが悪さをしている場合、非表示のものは完全に消す */
        .overlay.hidden {
            display: none !important;
            z-index: -1 !important;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
</head>

<body>
    <div id="screen-title" class="screen active">
        <div class="title-container">
            <div class="logo-container">
                <img id="top-logo" src="assets/top_logo.jpg" alt="異能 CHINCHIRO ROYALE">
            </div>

            <div class="title-menu">
                <div class="input-group">
                    <input type="text" id="input-player-name" class="gold-input" placeholder="プレイヤー名を入力" maxlength="20">
                </div>

                <button id="btn-create-room" class="gold-button primary">
                    <span class="btn-icon">👑</span>
                    <span class="btn-text">部屋を作成</span>
                </button>

                <div class="divider">
                    <span>OR</span>
                </div>

                <div class="input-group">
                    <input type="text" id="input-room-id" class="gold-input" placeholder="ルームIDを入力" maxlength="6">
                </div>

                <button id="btn-join-room" class="gold-button secondary">
                    <span class="btn-icon">🚪</span>
                    <span class="btn-text">部屋に参加</span>
                </button>
            </div>

            <p class="version-info">ver 1.0.0</p>
        </div>
    </div>

    <div id="screen-lobby" class="screen">
        <div class="lobby-container">
            <div class="lobby-header">
                <h2 class="lobby-title">WAITING ROOM</h2>
                <div class="room-id-display">
                    <span class="label">ROOM ID:</span>
                    <span id="display-room-id" class="room-id">------</span>
                    <button id="btn-copy-room-id" class="icon-button" title="コピー">📋</button>
                </div>
            </div>

            <div class="player-list-container">
                <h3 class="section-title">参加者 <span id="player-count">(0/8)</span></h3>
                <ul id="lobby-player-list" class="player-list">
                </ul>
            </div>

            <div class="lobby-status">
                <p id="lobby-message" class="status-message">他のプレイヤーを待っています...</p>
            </div>

            <div class="lobby-actions">
                <button id="btn-start-game" class="gold-button primary large" disabled>
                    <span class="btn-icon">🎲</span>
                    <span class="btn-text">ゲーム開始</span>
                </button>
                <button id="btn-leave-room" class="gold-button danger">退出</button>
            </div>
        </div>
    </div>

    <div id="screen-game" class="screen">
        <div class="game-log-panel">
            <h3 class="panel-title">GAME LOG</h3>
            <div id="game-log" class="log-content">
            </div>
        </div>

        <div class="other-players-panel">
            <div id="other-players" class="other-players-grid">
            </div>
        </div>

        <div class="main-stage">
            <div class="round-info">
                <span class="round-label">ROUND</span>
                <span id="round-number" class="round-number">1</span>
            </div>

            <div class="dealer-area">
                <div class="dealer-label">
                    <span class="crown">👑</span>
                    <span id="dealer-name">親プレイヤー</span>
                </div>
                <div id="dealer-dice" class="dice-display">
                    <div class="dice">?</div>
                    <div class="dice">?</div>
                    <div class="dice">?</div>
                </div>
                <div id="dealer-hand" class="hand-result">-</div>
            </div>

            <div class="vs-display">
                <span class="vs-text">VS</span>
            </div>

            <div class="current-player-area">
                <div id="current-player-name" class="current-player-label">-</div>
                <div id="current-player-dice" class="dice-display">
                    <div class="dice">?</div>
                    <div class="dice">?</div>
                    <div class="dice">?</div>
                </div>
                <div id="current-player-hand" class="hand-result">-</div>
            </div>
        </div>

        <div class="player-control-panel">
            <div class="player-info">
                <div class="player-name-display">
                    <span id="my-name">プレイヤー名</span>
                    <span id="my-role-badge" class="role-badge"></span>
                </div>
                <div class="chips-display">
                    <span class="chips-icon">💰</span>
                    <span id="my-chips">1000</span>
                </div>
            </div>

            <div id="bet-controls" class="control-group hidden">
                <h4 class="control-label">BET</h4>
                <div class="bet-buttons">
                    <button class="bet-btn" data-amount="1000">+1000</button>
                    <button class="bet-btn" data-amount="5000">+5000</button>
                    <button class="bet-btn" data-amount="10000">+10000</button>
                    <button class="bet-btn" data-amount="50000">+50000</button>
                    <button class="bet-btn bet-all" data-amount="all">ALL</button>
                    <button class="bet-btn bet-reset" data-amount="reset">リセット</button>
                </div>

                <div class="current-bet">
                    <span class="label">BET:</span>
                    <span id="bet-amount">0</span>
                </div>
                <button id="btn-confirm-bet" class="gold-button primary">ベット確定</button>
            </div>

            <div id="roll-controls" class="control-group hidden">
                <button id="btn-roll-dice" class="gold-button primary large roll-button">
                    <span class="btn-icon">🎲</span>
                    <span class="btn-text">ROLL</span>
                </button>
            </div>

            <div id="skill-controls" class="control-group">
                <div class="skill-card" id="my-skill-card">
                    <div class="skill-name" id="my-skill-name">スキル未配布</div>
                    <div class="skill-desc" id="my-skill-desc">-</div>
                    <button id="btn-use-skill" class="skill-button" disabled>発動</button>
                </div>
            </div>

        </div>

        <div id="skill-action-modal" class="modal hidden">
            <div class="modal-content">
                <h3 id="skill-action-title">スキル発動</h3>
                <p id="skill-action-prompt">選択してください</p>
                <div id="skill-action-options" class="action-options">
                </div>
            </div>
        </div>

        <div id="result-overlay" class="overlay hidden">
            <div class="result-content">
                <h2 id="result-title" class="result-title">-</h2>
                <div id="result-details" class="result-details">
                </div>
                <div id="result-actions" class="result-actions hidden">
                    <button id="btn-rematch" class="gold-button primary">
                        <span class="btn-icon">🔄</span>
                        <span class="btn-text">再戦</span>
                    </button>
                    <button id="btn-back-to-lobby" class="gold-button secondary">
                        <span class="btn-icon">🚪</span>
                        <span class="btn-text">ロビーへ戻る</span>
                    </button>
                </div>
            </div>
        </div>


        <div id="freeze-overlay" class="overlay freeze-overlay hidden"></div>
    </div>

    <div id="toast-container" class="toast-container">
    </div>

    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script type="module" src="scripts/main.js?v=6"></script>
</body>

</html>